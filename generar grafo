import psycopg2 as ps
import networkx as nx 
import matplotlib.pyplot as plt
connection1= ps.connect(
    host="localhost",
    user="minipekka",
    password="12345",
    database="Grafos"
    )
cursor=connection1.cursor()
cursor.execute("select track_name,genre from completa")
nom=cursor.fetchall()
relacion1=[]
relacion2=[]

for i in nom:
    a=[i[0],i[1]]
    relacion1.append(a)


cursor.execute("select track_name,topic from completa")
top=cursor.fetchall()
for i in top:
    b=[i[0],i[1]]
    relacion2.append(b)

gm=nx.Graph()
for i in range(len(nom)):
    gm.add_node(i,label=nom[i][0])

genre_dict = {}

for i, track in enumerate(nom):
    track_name, genre = track
    if genre not in genre_dict:
        genre_dict[genre] = []
    genre_dict[genre].append(i)

# Agregar aristas solo entre tracks del mismo género
for genre, tracks in genre_dict.items():
    for i in range(len(tracks)):
        for j in range(i + 1, len(tracks)):  # Para evitar duplicación de aristas
            gm.add_edge(tracks[i], tracks[j])

pos = nx.spring_layout(gm)
nx.draw(gm, pos, with_labels=True, font_weight='bold')
plt.show()

cursor.close()
connection1.close()
